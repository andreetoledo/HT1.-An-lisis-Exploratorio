---
title: "Análisis Exploratorio, HDT 1"
author: "Ayleen Rubio 19003, Andrés Say 19705. Andreé Toledo 18439"
date: "4/2/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

knitr::opts_knit$set(root.dir="C:/Users/andre/OneDrive/Documentos/HT1.Analisis-Exploratorio")

```

# Informe de análisis exploratorio 
En este informe usted podrá leer los hallazgos de EDA, a continuación se muestra el resumen de los datos:

```{r movies, echo=FALSE}
sum_movies <- read.csv("tmdb-movies.csv")
summary(sum_movies)
```

En el siguiente cuadro se muestra el tipo de dato de cada variable:

```{r data, echo=FALSE}
str(sum_movies)
```
## Prueba de normalidad para datos cuantitativos  

Se han escogido las variables cuantitativas que podrían seguir una distribución normal, como lo es el presupuesto o los ingresos, ya que variables como el Id de la película no son datos relevantes para hacer un análisis estadístico.

### Prueba de normalidad para popularity:
```{r normalHist, echo=FALSE}
#install.packages("ggplot2",repos = "http://cran.us.r-project.org")
library (ggplot2)
ggplot(data = sum_movies, aes(x = popularity)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(sum_movies$popularity),
                            sd = sd(sum_movies$popularity)))+
  ggtitle("Histograma con curva normal teórica de la popularidad") + 
  theme_bw()
```  

Como puede observarse, no se sigue una forma de campana y no se cuenta con simetría, por lo que no cumple con la normalidad.

```{r normalBox, echo=FALSE}
boxplot(sum_movies$popularity, main = "Caja y Bigotes de Popularidad", xlab = "Popularidad")

```

En este gráfico se observan muchos puntos atípicos y no se parece que siga una distribución normal.

```{r normalQQ, echo=FALSE}
qqnorm(sum_movies$popularity, col="blue")
qqline(sum_movies$popularity, col="red")
```

En este gráfico se puede observar que tampoco se cumple la normalidad ya que los valores no se encuentran alineados.

### Prueba de normalidad para el presupuesto:
```{r normalHist2, echo=FALSE}
library (ggplot2)
ggplot(data = sum_movies, aes(x = budget)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(sum_movies$budget),
                            sd = sd(sum_movies$budget)))+
  ggtitle("Histograma con curva normal teórica del presupuesto") + 
  theme_bw()

```

Como puede observarse, no se sigue una forma de campana y no se cuenta con simetría, por lo que no cumple con la normalidad.

```{r normalBox2, echo=FALSE}
boxplot(sum_movies$budget, main = "Caja y Bigotes de Presupuesto")

```

En este gráfico se observan muchos puntos atípicos y no se parece que siga una distribución normal.

```{r normalQQ2, echo=FALSE}
qqnorm(sum_movies$budget, col="blue")
qqline(sum_movies$budget, col="red")
```

En este gráfico se puede observar que tampoco se cumple la normalidad ya que los valores no se encuentran alineados.

### Prueba de normalidad para los ingresos:

```{r normalHist3, echo=FALSE}
library (ggplot2)
ggplot(data = sum_movies, aes(x = revenue)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(sum_movies$revenue),
                            sd = sd(sum_movies$revenue)))+
  ggtitle("Histograma con curva normal teórica de los ingresos") + 
  theme_bw()

```

Como puede observarse, no se sigue una forma de campana y no se cuenta con simetría, por lo que no cumple con la normalidad.

```{r normalBox3, echo=FALSE}
boxplot(sum_movies$revenue, main = "Caja y Bigotes de los ingresos")

```

En este gráfico se observan muchos puntos atípicos y no se parece que siga una distribución normal.

```{r normalQQ3, echo=FALSE}
qqnorm(sum_movies$revenue, col="blue")
qqline(sum_movies$revenue, col="red")
```

En este gráfico se puede observar que tampoco se cumple la normalidad ya que los valores no se encuentran alineados.

### Prueba de normalidad para la duración de la película:

```{r normalHist4, echo=FALSE}
library (ggplot2)
ggplot(data = sum_movies, aes(x = runtime)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(sum_movies$runtime),
                            sd = sd(sum_movies$runtime)))+
  ggtitle("Histograma con curva normal teórica de la duracion de la pelicula") + 
  theme_bw()

```

Como puede observarse, sí se sigue una forma de campana y sí se cuenta con simetría, por lo que en este caso sí se cumple con la normalidad

```{r normalBox4, echo=FALSE}
boxplot(sum_movies$runtime, main = "Caja y Bigotes de la duración")

```

En este gráfico se observan muchos puntos atípicos y no se parece que siga una distribución normal.

```{r normalQQ4, echo=FALSE}
qqnorm(sum_movies$runtime, col="blue")
qqline(sum_movies$runtime, col="red")
```

En este gráfico se puede observar que tampoco se cumple la normalidad ya que los valores no se encuentran alineados.

Debido a que dos de las tres pruebas no cumplen con normalidad, no puede afirmarse que la duración de las películas siga una distribución normal.

### Prueba de normalidad para el número de votos:

```{r normalHist5, echo=FALSE}
library (ggplot2)
ggplot(data = sum_movies, aes(x = vote_count)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(sum_movies$vote_count),
                            sd = sd(sum_movies$vote_count)))+
  ggtitle("Histograma con curva normal teórica del número de votos") + 
  theme_bw()

```

Como puede observarse, no se sigue una forma de campana y no se cuenta con simetría, por lo que no cumple con la normalidad.

```{r normalBox5, echo=FALSE}
boxplot(sum_movies$vote_count, main = "Caja y Bigotes del numero de votos")

```

En este gráfico se observan muchos puntos atípicos y no se parece que siga una distribución normal.

```{r normalQQ5, echo=FALSE}
qqnorm(sum_movies$vote_count, col="blue")
qqline(sum_movies$vote_count, col="red")
```

En este gráfico se puede observar que tampoco se cumple la normalidad ya que los valores no se encuentran alineados.

### Prueba de normalidad para el promedio del número de votos:

```{r normalHist6, echo=FALSE}
library (ggplot2)
ggplot(data = sum_movies, aes(x = vote_average)) + 
  geom_histogram(aes(y=..density.., fill = ..count..))+
  scale_fill_gradient(low = "#DCDCDC", high = "#7C7C7C")+
  stat_function(fun = dnorm, colour = "firebrick",
                args = list(mean = mean(sum_movies$vote_average),
                            sd = sd(sum_movies$vote_average)))+
  ggtitle("Histograma con curva normal teórica del promedio de número de votos") + 
  theme_bw()

```

Como puede observarse, sí se sigue una forma de campana y no sí cuenta con simetría, por lo que sí cumple con la normalidad.

```{r normalBox6, echo=FALSE}
boxplot(sum_movies$vote_average, main = "Caja y Bigotes del promedio de numero de votos")

```

En este gráfico se observa que se sigue una distribución normal.

```{r normalQQ6, echo=FALSE}
qqnorm(sum_movies$vote_average, col="blue")
qqline(sum_movies$vote_average, col="red")
```

En este gráfico se puede observar que también se cumple la normalidad ya que los valores sí se encuentran alineados.

En conclusión, la única variable que sigue una distribución normal es el promedio de votos en la plataforma para las películas, esto puede ser debido a que algunas variables, como el presupuesto, ganancias y la duración, se encuentran en diferentes escalas.


## Tabla de frecuencias para variables cualitativas

### Tabla de frecuencias para los géneros
```{r cast, echo=FALSE}


#sum_movies <- read.csv("tmdb-movies.csv")
#table(separate(sum_movies$genres, sep = "|"))

sum_movies <- read.csv(
  "tmdb-movies.csv")
#table(sum_movies$genre)

genres <- data.frame(table(do.call(c, lapply(sum_movies$genres, function(x) unlist(strsplit(x, "\\|"))))))
table(genres)
```

### Tabla de frecuencias para Companias productoras
```{r cast2, echo=FALSE}
sum_movies <- read.csv(
  "tmdb-movies.csv")


production_companies <- data.frame(table(do.call(c, lapply(sum_movies$production_companies, function(x) unlist(strsplit(x, "\\|"))))))
table(production_companies)
```

## Anio y fecha de lanzamientos
```{r dates, echo=FALSE}
sum_movies <- read.csv(
  "tmdb-movies.csv")


release_year <- data.frame(table(sum_movies$release_year))
release_date <- data.frame(table(sum_movies$release_date))

library (ggplot2)

ggplot(sum_movies, aes(release_year)) +
    labs(title='Anios de lanzamiento')+
    geom_histogram(fill="blue") 
 
```

```{r}
##¿Cuales son las 10 peliculas que contaron con más presupuesto?
library(dplyr)
library(magrittr)
top_n(sum_movies,9,sum_movies$budget)

```{r}
##¿Cuales son las 10 peliculas que más ingresos tuvieron?
top_n(sum_movies,10,sum_movies$revenue)

```{r}
##¿Cuál es la pelicula con más votos?
sum_movies[which.max(sum_movies$vote_count),]

```{r}
##¿Cuál es la pelicula con más votos?
sum_movies[which.min(sum_movies$vote_count),]

```{r}
##¿Cuál es el género principal de las 20 películas más populares
top20 <- top_n(sum_movies,20,sum_movies$popularity)
resp6 <- top_n(top20, 1, top20$genres)
resp6



